---
- name: libselinux-python installed
  package: name=libselinux-python state=latest

- name: disable selinux
  selinux: state=disabled

- name: is_getenforce
  command: /usr/sbin/getenforce
  register: is_getenforce
- fail: msg="SELinux is turned off. please run again, 'vagrant reload --provision'"
  when: is_getenforce.stdout == 'Enforcing' or is_getenforce.stdout == 'Permissive'

- name: ntp installed
  package: name=ntp

- name: ntp started and enabled
  service: name=ntpd state=restarted enabled=yes

- name: create swap space
  command: dd if=/dev/zero of=/swapfile bs=1M count=1024
  ignore_errors: yes
  when: ansible_swaptotal_mb < 1

- name: Make swap
  command: mkswap /swapfile
  ignore_errors: yes
  when: ansible_swaptotal_mb < 1

- name: swapon
  command: swapon /swapfile
  ignore_errors: yes

- name: edit PATH on .bash_profile
  lineinfile: dest={{ bash_profile }} line="export PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/sbin:$PATH"

- name: edit PATH on .bashrc
  lineinfile: dest={{ bashrc }} line="export PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/sbin:$PATH"

- name: unzip installed
  package: name=unzip state=latest

- name: patch installed
  package: name=patch state=latest

- name: include task (CentOS/RHEL 6)
  include: centos6.yml
  when: ansible_os_family == 'RedHat' and ansible_distribution_major_version|int == 6

- name: include task (CentOS/RHEL 7)
  include: centos7.yml
  when: ansible_os_family == 'RedHat' and ansible_distribution_major_version|int == 7

- include: reset.yml
